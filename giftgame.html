<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Catch the Gift - Synergia</title>

<style>
  body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
    overflow: hidden;
    color: white;
  }

  #startScreen, #gameArea {
    width: 100%;
    height: 100vh;
    position: absolute;
  }

  /* ---------- RULES SCREEN ---------- */
  #startScreen {
    display: flex;
    justify-content: center;
    align-items: center;
  }

  #rulesBox {
    background: linear-gradient(145deg, #1f3c88, #3a7bd5);
    padding: 30px;
    border-radius: 20px;
    width: 90%;
    max-width: 420px;
    text-align: center;
    box-shadow: 0 0 25px rgba(0,0,0,0.5);
  }

  #rulesBox h2 { margin-top: 0; }

  #startBtn {
    margin-top: 20px;
    padding: 15px 35px;
    font-size: 22px;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    background: gold;
    color: black;
    font-weight: bold;
  }

  /* ---------- GAME AREA ---------- */
  #gameArea { display: none; }

  #basket {
    position: absolute;
    bottom: 25px;
    left: 50%;
    transform: translateX(-50%);
    width: 90px;
    height: 55px;
    background: #8b4513;
    border-radius: 12px;
    text-align: center;
    color: white;
    font-size: 32px;
    line-height: 55px;
  }

  .gift {
    position: absolute;
    top: -40px;
    font-size: 34px;   /* FIXED SIZE (same on phone & laptop) */
  }

  #scoreBoard {
    position: absolute;
    top: 15px;
    left: 15px;
    font-size: 20px;
    background: white;
    color: black;
    padding: 10px 15px;
    border-radius: 10px;
  }

  #message {
    position: absolute;
    top: 40%;
    width: 100%;
    text-align: center;
    font-size: 30px;
    font-weight: bold;
  }

  #formBtn, #playAgainBtn {
    position: absolute;
    top: 60%;
    left: 50%;
    transform: translateX(-50%);
    padding: 15px 30px;
    font-size: 20px;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    display: none;
  }

  #formBtn { background: #28a745; color: white; }
  #playAgainBtn { background: #ff9800; color: white; }

  canvas { position: absolute; top: 0; left: 0; pointer-events: none; }
</style>
</head>

<body>

<!-- RULES SCREEN -->
<div id="startScreen">
  <div id="rulesBox">
    <h2>üéÅ Catch the Gift Challenge</h2>
    <p>
      ‚Ä¢ Catch <b>14 points</b> in <b>25 seconds</b><br><br>
      üéÅ Gift = +1 point<br>
      üåü Golden Gift = +2 points (rare)<br>
      üí£ Bomb = ‚àí1 point (avoid!)<br><br>
      Controls:<br>
      ‚¨ÖÔ∏è‚û°Ô∏è Arrow Keys (Laptop)<br>
      üëâ Swipe / Drag (Mobile & Mouse)<br><br>
      Win to unlock registration!
    </p>

    <button id="startBtn" onclick="startGame()">‚ñ∂Ô∏è Start Game</button>
  </div>
</div>

<!-- GAME AREA -->
<div id="gameArea">

  <div id="scoreBoard">
    Score: <span id="score">0</span> / 14 <br>
    Time: <span id="time">25</span>s
  </div>

  <div id="basket">üß∫</div>

  <div id="message"></div>

  <button id="formBtn" onclick="openForm()">üéâ Proceed to Registration</button>
  <button id="playAgainBtn" onclick="resetGame()">üîÑ Play Again</button>

  <canvas id="confetti"></canvas>

</div>

<!-- Sounds -->
<audio id="catchSound" src="https://assets.mixkit.co/sfx/preview/mixkit-game-ball-tap-2073.mp3"></audio>
<audio id="bombSound" src="https://assets.mixkit.co/sfx/preview/mixkit-arcade-bomb-2165.mp3"></audio>

<script>
  const basket = document.getElementById("basket");
  const gameArea = document.getElementById("gameArea");
  const startScreen = document.getElementById("startScreen");
  const scoreText = document.getElementById("score");
  const timeText = document.getElementById("time");
  const message = document.getElementById("message");
  const formBtn = document.getElementById("formBtn");
  const playAgainBtn = document.getElementById("playAgainBtn");

  let basketX, score, timeLeft, gameRunning;
  let timerInterval, giftInterval;
  let fallSpeed;

  /* ---------- CONTROLS ---------- */

  // Arrow keys (FASTER X movement)
  document.addEventListener("keydown", (e) => {
    if (!gameRunning) return;
    if (e.key === "ArrowLeft") basketX -= 60;
    if (e.key === "ArrowRight") basketX += 60;
    keepInside();
  });

  // Mouse move
  gameArea.addEventListener("mousemove", (e) => {
    if (!gameRunning) return;
    basketX = e.clientX - 45;
    keepInside();
  });

  // Swipe (mobile)
  gameArea.addEventListener("touchmove", (e) => {
    if (!gameRunning) return;
    e.preventDefault();
    basketX = e.touches[0].clientX - 45;
    keepInside();
  }, { passive: false });

  function keepInside() {
    const max = window.innerWidth - 90;
    if (basketX < 0) basketX = 0;
    if (basketX > max) basketX = max;
    basket.style.left = basketX + "px";
  }

  /* ---------- GAME LOGIC ---------- */

  function startGame() {
    startScreen.style.display = "none";
    gameArea.style.display = "block";

    score = 0;
    timeLeft = 25;
    fallSpeed = 4.5;
    basketX = window.innerWidth / 2 - 45;
    gameRunning = true;

    scoreText.textContent = score;
    timeText.textContent = timeLeft;
    message.textContent = "";
    formBtn.style.display = "none";
    playAgainBtn.style.display = "none";

    basket.style.left = basketX + "px";

    timerInterval = setInterval(updateTime, 1000);
    giftInterval = setInterval(createItem, 650);
  }

  function updateTime() {
    timeLeft--;
    timeText.textContent = timeLeft;
    fallSpeed += 0.25;   // harder over time

    if (timeLeft <= 0) endGame(false);
  }

  function createItem() {
    if (!gameRunning) return;

    const item = document.createElement("div");
    item.classList.add("gift");

    const chance = Math.random();
    let type;

    if (chance < 0.05) { type = "gold"; item.textContent = "üåü"; }
    else if (chance < 0.25) { type = "bomb"; item.textContent = "üí£"; }
    else { type = "normal"; item.textContent = "üéÅ"; }

    item.dataset.type = type;
    item.style.left = Math.random() * (window.innerWidth - 40) + "px";
    gameArea.appendChild(item);

    let fall = 0;
    const speed = fallSpeed + Math.random() * 2;

    const fallInterval = setInterval(() => {
      fall += speed;
      item.style.top = fall + "px";

      const r1 = item.getBoundingClientRect();
      const r2 = basket.getBoundingClientRect();

      if (r1.bottom >= r2.top && r1.left < r2.right && r1.right > r2.left) {
        handleCatch(type);
        item.remove();
        clearInterval(fallInterval);
        if (score >= 14) endGame(true);
      }

      if (fall > window.innerHeight) {
        item.remove();
        clearInterval(fallInterval);
      }
    }, 30);
  }

  function handleCatch(type) {
    if (type === "normal") score++;
    if (type === "gold") score += 2;
    if (type === "bomb") { score--; if (score < 0) score = 0; }

    scoreText.textContent = score;
  }

  function endGame(win) {
    gameRunning = false;
    clearInterval(timerInterval);
    clearInterval(giftInterval);

    playAgainBtn.style.display = "block";

    if (win) {
      message.textContent = "üéâ YOU WIN!";
      formBtn.style.display = "block";
      startConfetti();
    } else {
      message.textContent = "‚è±Ô∏è Time Up! Try Again.";
    }
  }

  function resetGame() {
    gameArea.style.display = "none";
    startScreen.style.display = "flex";
  }

  function openForm() {
    window.open("https://forms.gle/YOUR_FORM_LINK_HERE", "_blank");
  }

  /* ---------- CONFETTI ---------- */

  const canvas = document.getElementById("confetti");
  const ctx = canvas.getContext("2d");

  function startConfetti() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    let pieces = [];
    for (let i = 0; i < 150; i++) {
      pieces.push({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        r: Math.random() * 6 + 4,
        d: Math.random() * 50
      });
    }

    function draw() {
      ctx.clearRect(0,0,canvas.width,canvas.height);
      pieces.forEach(p => {
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
        ctx.fillStyle = "gold";
        ctx.fill();
        p.y += 3;
      });
      requestAnimationFrame(draw);
    }

    draw();
  }
</script>

</body>
</html>
